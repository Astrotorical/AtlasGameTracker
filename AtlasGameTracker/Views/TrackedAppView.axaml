<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:models="using:AtlasGameTrackerLibrary.models"
             xmlns:views="using:AtlasGameTrackerUI"
             xmlns:vm="using:AtlasGameTrackerUI.ViewModels"
             x:DataType="vm:TrackedAppViewModel"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="AtlasGameTrackerUI.TrackedAppView">
<UserControl.DataContext>
	<vm:TrackedAppViewModel/>
</UserControl.DataContext>
    
<SplitView IsPaneOpen="{Binding IsPanelOpen}"
           OpenPaneLength="300"
           CompactPaneLength="0"
           DisplayMode="CompactInline">
	<SplitView.Pane>
        <StackPanel>
            <TextBlock Text="Registered Applications" FontSize="18" Margin="10" Padding="5"/>
            <ListBox ItemsSource="{Binding RegisteredApps}" SelectedItem="{Binding SelectedApp}" SelectionChanged="OnSelectedAppChanged">
                <ListBox.ItemTemplate>
                    <DataTemplate x:DataType="models:RegisteredApp">
                        <TextBlock Text="{Binding DisplayName}" FontSize="16" Margin="5"/>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
        </StackPanel>
    </SplitView.Pane>
    <SplitView.Content>
        <StackPanel>
            <Button Command="{Binding TogglePanelCommand}">
                <Image Source="avares://AtlasGameTrackerUI/Assets/3lines.png" Width="24" Height="24"/>
            </Button>
            <StackPanel Margin="20" IsVisible="{Binding HasSelectedApp}">
				<TextBlock Text="{Binding SelectedApp.DisplayName}" FontSize="24" FontWeight="Bold" Margin="0,0,0,10"/>
                <TextBlock Text="Application Process Name:" FontSize="18" FontWeight="SemiBold"/>
                <TextBlock Text="{Binding SelectedApp.ProcessName}" FontSize="16" Margin="0,0,0,10"/>
                <TextBlock Text="Total Playtime:" FontSize="18" FontWeight="SemiBold"/>
                <TextBlock Text="{Binding SelectedApp.TotalPlaytime, StringFormat='{} {0} hrs'}" FontSize="16" Margin="0,0,0,10"/>
                <TextBlock Text="Toggle Tracking:" FontSize="18" FontWeight="SemiBold"/>
                <ToggleSwitch IsChecked="{Binding IsTrackingEnabled}" Command="{Binding ToggleTrackingCommand}" FontSize="16"/>
                <TextBlock Text="Sessions:" FontSize="18" FontWeight="SemiBold"/>
                <ListBox ItemsSource="{Binding SelectedApp.Sessions}" MaxHeight="250">
                    <ListBox.ItemTemplate>
                        <DataTemplate x:DataType="models:Session">
                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <TextBlock FontWeight="Bold" Text="{Binding SessionDuration, StringFormat='{} {0} hrs'}"/>
                                <TextBlock Text="{Binding StartTime}"/>
                                <TextBlock Text=" - "/>
                                <TextBlock Text="{Binding EndTime}"/>
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </StackPanel>
            <TextBlock Text="No application selected." FontSize="18" FontStyle="Italic" Margin="20" IsVisible="{Binding !HasSelectedApp}"/>
        </StackPanel>
    </SplitView.Content>
</SplitView>

</UserControl>
